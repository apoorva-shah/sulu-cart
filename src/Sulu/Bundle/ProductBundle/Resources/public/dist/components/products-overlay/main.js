define([],function(){"use strict";var a={translations:{addProducts:"sulu.products.add-products",productName:"sulu.products.productName"},filter:{parent:!1,types:[]}},b={productsDataGrid:function(){return['<div id="',this.options.searchInstanceName,'"></div>','<div id="',this.options.dataGridInstanceName,'" />'].join("")}},c="sulu.products.products-overlay.",d=function(a){return c+(this.options.instanceName?this.options.instanceName+".":"")+a},e=function(){return d.call(this,"open")},f=function(){return d.call(this,"add")},g=function(){var a="/admin/api/products?flat=true";return this.options.filter.parent!==!1&&(a+="&parent="+(null===this.options.filter.parent?"null":this.options.filter.parent)),this.options.filter.types.length>0&&(a+="&type="+this.options.filter.types.join(",")),a},h=function(){m.call(this);var a=this.sandbox.dom.createElement("<div/>");this.sandbox.dom.append(this.$el,a),this.sandbox.start([{name:"overlay@husky",options:{el:a,instanceName:this.options.instanceName,slides:[{title:this.sandbox.translate(this.options.translations.addProducts),data:b.productsDataGrid.call(this)}]}}])},i=function(){this.sandbox.start([{name:"datagrid@husky",options:{el:"#"+this.options.dataGridInstanceName,instanceName:this.options.dataGridInstanceName,url:g.call(this),resultKey:"products",pagination:!1,viewOptions:{table:{excludeFields:["id"],showHead:!1,cssClass:"minimal",selectItem:!1}},matchings:[{name:"id"},{name:"name",translation:this.options.translations.productName}]}}])},j=function(){this.sandbox.emit("husky.overlay."+this.options.instanceName+".open")},k=function(a){this.sandbox.emit(f.call(this),a)},l=function(){this.sandbox.emit("husky.overlay."+this.options.instanceName+".set-position")},m=function(){this.sandbox.once("husky.overlay."+this.options.instanceName+".opened",function(){i.call(this)},this),this.sandbox.on(e.call(this),function(){j.call(this)},this),this.sandbox.on("husky.datagrid."+this.options.dataGridInstanceName+".item.click",function(a){k.call(this,a)},this),this.sandbox.on("husky.datagrid."+this.options.dataGridInstanceName+".view.rendered",function(){l.call(this)},this)};return{initialize:function(){this.options=this.sandbox.util.extend({},a,this.options),this.options.dataGridInstanceName=this.options.instanceName+"-datagrid",this.options.searchInstanceName=this.options.instanceName+"-search",h.call(this)}}});